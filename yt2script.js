var def_thumb=_siteurl+"template/img/def-thumb.jpg",isreconnect=0,maxreconnect=3,reconnectcount=0,audiocanembed=["mp3","aac","ogg","m4a","flac","wav","webm"],videocanembed=["mp4","m4v","mov","mkv","3gp"],progresstime=1e3,zerocount=0,maxzerocount=10,_gsite="https://h2converter.com/";function guid(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()+e()+e()+e()+e()}function progressbg(e){$(".percent").html(parseInt(e,10)),$(".progress-bar").animate({width:e+"%"},100)}$(document).ready(function(){var t,n,o,r,a,i,s,c="button"!=_page?e:eshort,d=0,l=0,u=0,f=0,h=0,m=0,g="",v="",b="";function k(e){if(a=e,-1<(e=$.trim(e)).indexOf("www.facebook.com/")&&e.indexOf("/videos/")>-1){var t=e.split("/videos/"),n=parseInt(t[1]);if(t[1].indexOf("pcb.")>-1){var o=t[1].split("/");n=parseInt(o[1])}}else if(-1<e.indexOf("m.facebook.com/")&&-1<e.indexOf("story_fbid="))t=e.split("story_fbid="),n=parseInt(t[1]);else if(-1<e.indexOf("youtube.com/")&&-1<e.indexOf("v="))n=(t=e.split("v="))[1].substring(0,11);else if(-1<e.indexOf("youtu.be/"))n=(t=e.split("youtu.be/"))[1].substring(0,11);return i=n,void 0!==n&&n}function y(e){v=e,M(),"button"!=_page?($("#converter_wrapper").before('<div id="error"><span>'+e+" "+alternative+"</span></div>"),$("#converter_wrapper").remove(),$("#error").show()):$("#progresstext").html(e)}function w(e){$("#progresstext").html(e)}var x=2,C=0,_=0,T=0,j="",z="";function I(e,r,a){v="",s=1,void 0!==e&&void 0!==r&&void 0!==H?($("#submit").hide(),$("#loading").show(),$(".percent").hide(),$("#settings").hide(),$("#progresstext").show(),w('<i class="fa fa-cog fa-spin fa fa-fw margin-bottom"></i>checking'),o=Math.round(+new Date/1e3),setTimeout(function(){P=$("#inputstart").is(":checked")?-1:$(".time-from").val(),Q=$("#inputend").is(":checked")?-1:$(".time-to").val(),"00:00:00"==P&&(P=-1),"00:00:00"==Q&&(Q=-1),$.ajax({method:"POST",url:_gsite+"json.php",data:{step:"choose",link:e,v:r,to:H,ql:K,st:P,en:Q,private:a,next:T},dataType:"jsonp",success:function(o){o.error&&("wait"==o.error?(w(c[o.error]),setTimeout(function(){I(e,r,a)},progresstime)):(y(c[o.error]),isreconnect=0)),o.success&&("cachend"==o.success?(v="cachend",t=o.convertid,d=o.bytes,z=o.api,l=o.duration,E(o)):"gop"==o.success?(t=o.convertid,d=o.bytes,l=o.duration,n=o.hash,j=o.path,z=o.apikey,O(o)):(t=o.convertid,n=o.hash,j=o.path,z=o.apikey,function(e,o,r){if(s=2,void 0===e||void 0===o||void 0===H)return void y(c.param);$("#submit").hide(),$("#loading").show(),$(".percent").hide(),$("#settings").hide(),$("#progresstext").show(),w('<i class="fa fa-cog fa-spin fa fa-fw margin-bottom"></i>loading'),setTimeout(function(){P=$("#inputstart").is(":checked")?-1:$(".time-from").val(),Q=$("#inputend").is(":checked")?-1:$(".time-to").val(),"00:00:00"==P&&(P=-1),"00:00:00"==Q&&(Q=-1),$.ajax({method:"GET",url:j+"connect/"+o,data:{step:"download",link:e,v:o,private:r,to:H,ql:K,st:P,en:Q,next:T,convertid:t,hash:n},dataType:"jsonp",success:function(e){O(e)}})},500)}(e,r,a)))}})},0)):y(c.param)}function O(t){if(t.error&&("connect"==t.error&&reconnectcount<=maxreconnect?(I(G,k,e),isreconnect=1,reconnectcount++):"download"==t.error?(T=1,I(G,k,e),isreconnect=0):"wait"==t.error?(w(c[t.error]),setTimeout(function(){I(G,k,e)},progresstime)):(y(c[t.error]),isreconnect=0)),t.success){if("direct"==t.note)return $("#downloadproxy").html('<a href="'+t.downloadproxy+'" target="_blank"><i class="fa fa-cloud-download" aria-hidden="true"></i> DL2</a>'),d=t.bytes,l=t.duration,void E(t);if("noaudio"==t.note&&(x=4,C=1),isreconnect=0,1==t.downloaded)l=t.duration,h=1,progressbg(100/x),$("#progresstext").hide(),$(".percent").show(),0==C?q():S();else 1==t.converted?(d=t.bytes,l=t.duration,m=1,progressbg(100),E(t)):(l=t.duration,R())}}function R(){s=2,0==isreconnect&&(reconnectcount=0),setTimeout(function(){$.ajax({method:"GET",url:j+"apijson.php",data:{step:"downloading",convertid:t,hash:n},dataType:"jsonp",success:function(e){if(e.error)"connect"==e.error&&reconnectcount<=maxreconnect?(R(),isreconnect=1,reconnectcount++):(y(c[e.error]),isreconnect=0);else{if(isreconnect=0,parseInt(e.percent)>0)progressbg(0==_?e.percent/x:e.percent/x+25),$("#progresstext").hide(),$(".percent").show();0==e.percent&&zerocount++,zerocount>=maxzerocount?(y(c.server),progresscancel(0)):parseInt(e.percent)<100?(u=e.percent,R(),"button"==_page&&$("#loading").show()):0==C?q():S()}}}).fail(function(){R()})},progresstime)}function S(){s=7,zerocount=0,0==isreconnect?reconnectcount=0:w(c.connectagain),setTimeout(function(){$.ajax({method:"GET",url:j+"apijson.php",data:{step:"saveaudio",convertid:t,hash:n},dataType:"jsonp",success:function(e){e.error&&("connect"==e.error&&reconnectcount<=maxreconnect?(S(),isreconnect=1,reconnectcount++):(y(c[e.error]),isreconnect=0)),e.success&&(_=1,isreconnect=0,1==e.downloaded?(progressbg(50),$("#progresstext").hide(),$(".percent").show(),function e(){s=8;zerocount=0;0==isreconnect?reconnectcount=0:w(c.connectagain);setTimeout(function(){$.ajax({method:"GET",url:j+"apijson.php",data:{step:"addaudio",convertid:t,hash:n},dataType:"jsonp",success:function(o){o.error&&("connect"==o.error&&reconnectcount<=maxreconnect?(e(),isreconnect=1,reconnectcount++):(y(c[o.error]),isreconnect=0)),o.success&&(isreconnect=0,1==o.added?(progressbg(75),$("#progresstext").hide(),$(".percent").show(),q()):1==o.converted?(progressbg(100),E(o)):function e(){s=9;0==isreconnect&&(reconnectcount=0);setTimeout(function(){$.ajax({method:"GET",url:j+"apijson.php",data:{step:"adding",convertid:t,hash:n},dataType:"jsonp",success:function(t){t.error?"connect"==t.error&&reconnectcount<=maxreconnect?(e(),isreconnect=1,reconnectcount++):(y(c[t.error]),isreconnect=0):(isreconnect=0,parseInt(t.percent)>0&&(progressbg(t.percent/x+50),$("#progresstext").hide(),$(".percent").show()),0==t.percent&&zerocount++,zerocount>=maxzerocount?(y(c.server),progresscancel(0)):parseInt(t.percent)<100?(f=t.percent,e(),"button"==_page&&$("#loading").show()):q())}}).fail(function(){e()})},progresstime)}())}})},0)}()):1==e.converted?(m=1,progressbg(100),E(e)):R())}})},0)}function q(){s=4,zerocount=0,0==isreconnect&&(reconnectcount=0),setTimeout(function(){$.ajax({method:"GET",url:j+"apijson.php",data:{step:"startconvert",convertid:t,hash:n},dataType:"jsonp",success:function(e){e.error&&("connect"==e.error&&reconnectcount<=maxreconnect?(q(),isreconnect=1,reconnectcount++):"downloading"==e.error?(R(),isreconnect=0):"download"==e.error?(T=1,I(W,k(W),0),isreconnect=0):(y(c[e.error]),isreconnect=0)),e.success&&(isreconnect=0,1==e.converted?(d=e.bytes,m=1,progressbg(100),E(e)):function e(){s=5;0==isreconnect&&(reconnectcount=0);setTimeout(function(){$.ajax({method:"GET",url:j+"apijson.php",data:{step:"converting",convertid:t,hash:n},dataType:"jsonp",success:function(t){if(t.error)"connect"==t.error&&reconnectcount<=maxreconnect?(e(),isreconnect=1,reconnectcount++):(y(c[t.error]),isreconnect=0);else{isreconnect=0;var n=100-100/x;progressbg(t.percent/x+n),0==t.percent&&zerocount++,zerocount>=maxzerocount?(y(c.server),progresscancel(0)):parseInt(t.percent)<100?(f=t.percent,e(),"button"==_page&&$("#loading").show()):t.linkconverted&&(d=t.bytes,E(t))}}}).fail(function(){e()})},progresstime)}())}})},0)}function E(t){setTimeout(function(){b=t.title;var n=t.linkconverted;g=n;var o="."+H,r=H.toUpperCase();"button"!=_page&&($("#title").text("").hide(),$("#result").css("padding-top","5px")),$("#sourceurl").text(t.title).attr("href",t.link),$("#convertedinfo").text(o+" "+t.filesize+" "+t.source.charAt(0).toUpperCase()+t.source.slice(1)),$("#fbprivate_title").text("");var a=""!=t.thumb?t.thumb:def_thumb;$("#thumb").css("background-image","url("+a+")"),$("#progress").hide(),$(".progress").hide(),$("#file").attr("href",n).attr("download",t.title+o),$(".subfile").text(" "+r+" ");var i=K.indexOf("x")>-1?"p":" kbps";"-1"!=K&&$(".subname").text(K+i).addClass("spanabs"),$("#result").show(),$("#download").show(),$("#pa_download").show();var s=0==e?G:t.link;$("#pa_downloada").attr("href","https://safechecker.site/go.php?id="+decodeURIComponent(s)),$("#dropbox").show();var c=0==e?G:t.link;$("#sharefb").attr("href","https://www.facebook.com/sharer/sharer.php?u="+_siteurl+"#url="+encodeURIComponent(c)+"&utm_source=facebook.com&utm_medium=Facebook_share&utm_campaign=www.facebook.com"),"button"==_page&&(window.location.href=n,$("#download-audio").prop("disabled",!1)),M()},10)}function M(){r=Math.round(+new Date/1e3),$.ajax({method:"POST",url:_gsite+"json.php",data:{step:"end",start:o,end:r,link:a,vid:i,title:b,to:H,ql:K,st:P,en:Q,bytes:d,duration:l,api:z,percentdownload:u,percentconvert:f,status:s,downloaded:h,converted:m,fileconverted:g,error:v,convertid:t,hash:n},dataType:"jsonp",success:function(e){}})}$(".play-btn").click(function(){var e=$("#file").attr("href");videocanembed.indexOf(H)>-1?$("#embed").html('<video style="width:100%;height:400px;margin-top:3px;" autoplay controls><source src="'+e+'"></video>'):audiocanembed.indexOf(H)>-1&&$("#embed").html('<audio style="width:50%;height:30px;margin-top:3px;" autoplay controls><source src="'+e+'"></audio>');var t=$("#embed").offset().top-70;$("html, body").animate({scrollTop:t},1e3)});var A=!1,U="",D="",G={ck:{1:e[1],2:e[2],3:e[3]},ct:{1:e[4],3:e[5],7:e[4],9:e[6],11:e[7],100:e[8]}};document.createElement("script");$("#submit").click(function(){if(0==(U=$("#myonoffswitch").is(":checked")?1:0)){var t=$("#input").val();return(D=k(t))?(A=!0,$("form").hide(),$("#progress").show(),I(t,D,U),!1):($("#input").attr("placeholder",e[0]),!1)}}),$("#input").keypress(function(e){if(13==e.which){if(0==(U=$("#myonoffswitch").is(":checked")?1:0)){var t=$("#input").val();return(D=k(t))?(A=!0,$("form").hide(),$("#progress").show(),I(t,D,U),!1):($("#input").attr("placeholder",e[0]),!1)}return!1}}),$("#submit_private").on("click",function(){A=1;var e=$("#viewsource").val().trim();$("#fbprivate_form").hide(),$("#progress").show(),U=$("#myonoffswitch").is(":checked")?1:0,p(e,"_",U)}),$("#myonoffswitch").on("change",function(){A||(1==(U=$("#myonoffswitch").is(":checked")?1:0)?($("#fblink").css("display","none"),$("#fbprivate").css("display","block")):($("#fbprivate").css("display","none"),$("#fblink").css("display","block")))});var F=["192","-1","-1"],N="audio-format",H="mp3",K="192",P="-1",Q="-1";function Z(e){$(".choosequality").removeClass("displayblock").addClass("displaynone"),$(".choosequality."+e).removeClass("displaynone").addClass("displayblock"),$("#advancedoptions .settinginput").removeClass("displaynone").addClass("displayblock"),"audio-format"==e||"flac-wav"==e?$("#settinglabel").html("Audio Quality"):$("#settinglabel").html("Video Quality"),N=e,function(e){var t="",n="audio-format"==e?0:1;"video-other"==e&&(n=2);if(F[n]!=K){var o="audio-format"==e?"192":"-1";$("#settingdropdown2 li a").each(function(e){(t=$(this).attr("data-value"))==o&&(K=t,$("#settingquality").html($(this).text()))})}}(e)}function L(e){var t,n,o=decodeURIComponent(V.substring(1)).split("&");for(n=0;n<o.length;n++)if((t=o[n].split("="))[0]===e)return void 0===t[1]||o[n].replace(e+"=","")}Z(N),$("#settinginput1").on("click",function(){$("#settingdropdown2").removeClass("displayblock").addClass("displaynone"),$("#settingdropdown1").hasClass("displaynone")?$("#settingdropdown1").removeClass("displaynone").addClass("displayblock"):$("#settingdropdown1").removeClass("displayblock").addClass("displaynone")}),$(".chooseformat").on("click",function(){$("#settingformat").html($(this).attr("data-value")),$(this).hasClass("audio-format")?Z("audio-format"):$(this).hasClass("video-format")?Z("video-format"):$(this).hasClass("video-other")?Z("video-other"):$(this).hasClass("flac-wav")&&($("#advancedoptions .settinginput").removeClass("displayblock").addClass("displaynone"),N="flac-wav"),$("#settingdropdown1").removeClass("displayblock").addClass("displaynone"),H=$(this).attr("data-value")}),$(".choosequality").on("click",function(){$("#settingquality").html($(this).text()),$("#settingdropdown2").removeClass("displayblock").addClass("displaynone"),K=$(this).attr("data-value");var e=$(this).hasClass("audio-format")?0:1;F[e]=K,$(this).hasClass("video-other")&&(F[2]=K)}),$("#moresettings").on("click",function(){$("#advancedoptions").slideToggle("slow",function(){$("#settingdropdown2").removeClass("displayblock").addClass("displaynone"),"flac-wav"!=N&&$("#advancedoptions .settinginput").removeClass("displaynone").addClass("displayblock")})}),$("#settinginput2").on("click",function(){$("#settingdropdown2").hasClass("displaynone")?$("#settingdropdown2").removeClass("displaynone").addClass("displayblock"):$("#settingdropdown2").removeClass("displayblock").addClass("displaynone")}),$(".custom_check input").on("click",function(){var e="inputstart"==$(this)[0].id?".time-from":".time-to";$(this).is(":checked")?$(e).removeClass("displayblock").addClass("displaynone"):$(e).removeClass("displaynone").addClass("displayblock")}),$(document).on("click",function(){$("#settingdropdown1").removeClass("displayblock").addClass("displaynone"),$("#settingdropdown2").removeClass("displayblock").addClass("displaynone")}),$(".settinginput").click(function(e){e.stopPropagation()}),$(".openhistory").on("click",function(){converthistory()});var V=window.location.hash.toString().replace("&utm_source=facebook.com&utm_medium=Facebook_share&utm_campaign=www.facebook.com",""),B=decodeURIComponent(L("url")),J=decodeURIComponent(L("format"));if(""!=B&&(-1<B.indexOf("fbcdn.net")&&-1<B.indexOf(".mp4?")?(A=1,$("#fblink").css("display","none"),$("#fbembed").css("display","block"),$("#fbembed_video").html('<video width="300" controls=""><source src="'+B+'"></video>'),$("#fbembed_download").attr("href",B),$("#fbembed_sharefb").attr("href","https://www.facebook.com/sharer/sharer.php?u="+_siteurl+"#url="+encodeURIComponent(B)+"&utm_source=facebook.com&utm_medium=Facebook_share&utm_campaign=www.facebook.com")):(D=k(B))&&($("#input").val(B),$("#fblink #title").html(c.selectoptions),$("#moresettings").click(),$(".chooseformat[data-value='"+J+"']").click())),"button"==_page){var W=$("#input").val();vid=k(W),H=$("#format").val(),K=$("#quality").val(),$("#download-audio").click(function(){""==$("#file").attr("href")?($("#download-audio").attr("disabled","disabled"),I(W,vid,0)):window.location.href=$("#file").attr("href")})}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){var t,n=navigator.userAgent,o=/iphone/i.test(n),r=/chrome/i.test(n),a=/android/i.test(n);e.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},e.fn.extend({caret:function(e,t){var n;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof e?(t="number"==typeof t?t:e,this.each(function(){this.setSelectionRange?this.setSelectionRange(e,t):this.createTextRange&&((n=this.createTextRange()).collapse(!0),n.moveEnd("character",t),n.moveStart("character",e),n.select())})):(this[0].setSelectionRange?(e=this[0].selectionStart,t=this[0].selectionEnd):document.selection&&document.selection.createRange&&(n=document.selection.createRange(),e=0-n.duplicate().moveStart("character",-1e5),t=e+n.text.length),{begin:e,end:t})},unmask:function(){return this.trigger("unmask")},mask:function(n,i){var s,c,d,l,u,p,f;if(!n&&this.length>0){var h=e(this[0]).data(e.mask.dataName);return h?h():void 0}return i=e.extend({autoclear:e.mask.autoclear,placeholder:e.mask.placeholder,completed:null},i),s=e.mask.definitions,c=[],d=p=n.length,l=null,e.each(n.split(""),function(e,t){"?"==t?(p--,d=e):s[t]?(c.push(new RegExp(s[t])),null===l&&(l=c.length-1),d>e&&(u=c.length-1)):c.push(null)}),this.trigger("unmask").each(function(){function h(){if(i.completed){for(var e=l;u>=e;e++)if(c[e]&&x[e]===m(e))return;i.completed.call(w)}}function m(e){return i.placeholder.charAt(e<i.placeholder.length?e:0)}function g(e){for(;++e<p&&!c[e];);return e}function v(e,t){var n,o;if(!(0>e)){for(n=e,o=g(t);p>n;n++)if(c[n]){if(!(p>o&&c[n].test(x[o])))break;x[n]=x[o],x[o]=m(o),o=g(o)}k(),w.caret(Math.max(l,e))}}function $(){y(),w.val()!=_&&w.change()}function b(e,t){var n;for(n=e;t>n&&p>n;n++)c[n]&&(x[n]=m(n))}function k(){w.val(x.join(""))}function y(e){var t,n,o,r=w.val(),a=-1;for(t=0,o=0;p>t;t++)if(c[t]){for(x[t]=m(t);o++<r.length;)if(n=r.charAt(o-1),c[t].test(n)){x[t]=n,a=t;break}if(o>r.length){b(t+1,p);break}}else x[t]===r.charAt(o)&&o++,d>t&&(a=t);return e?k():d>a+1?i.autoclear||x.join("")===C?(w.val()&&w.val(""),b(0,p)):k():(k(),w.val(w.val().substring(0,a+1))),d?t:l}var w=e(this),x=e.map(n.split(""),function(e,t){return"?"!=e?s[e]?m(t):e:void 0}),C=x.join(""),_=w.val();w.data(e.mask.dataName,function(){return e.map(x,function(e,t){return c[t]&&e!=m(t)?e:null}).join("")}),w.one("unmask",function(){w.off(".mask").removeData(e.mask.dataName)}).on("focus.mask",function(){var e;w.prop("readonly")||(clearTimeout(t),_=w.val(),e=y(),t=setTimeout(function(){w.get(0)===document.activeElement&&(k(),e==n.replace("?","").length?w.caret(0,e):w.caret(e))},10))}).on("blur.mask",$).on("keydown.mask",function(e){if(!w.prop("readonly")){var t,n,r,a=e.which||e.keyCode;f=w.val(),8===a||46===a||o&&127===a?(n=(t=w.caret()).begin,(r=t.end)-n==0&&(n=46!==a?function(e){for(;--e>=0&&!c[e];);return e}(n):r=g(n-1),r=46===a?g(r):r),b(n,r),v(n,r-1),e.preventDefault()):13===a?$.call(this,e):27===a&&(w.val(_),w.caret(0,y()),e.preventDefault())}}).on("keypress.mask",function(t){if(!w.prop("readonly")){var n,o,r,i=t.which||t.keyCode,s=w.caret();t.ctrlKey||t.altKey||t.metaKey||32>i||!i||13===i||(s.end-s.begin!=0&&(b(s.begin,s.end),v(s.begin,s.end-1)),n=g(s.begin-1),p>n&&(o=String.fromCharCode(i),c[n].test(o))&&(function(e){var t,n,o,r;for(t=e,n=m(e);p>t;t++)if(c[t]){if(o=g(t),r=x[t],x[t]=n,!(p>o&&c[o].test(r)))break;n=r}}(n),x[n]=o,k(),r=g(n),a?setTimeout(function(){e.proxy(e.fn.caret,w,r)()},0):w.caret(r),s.begin<=u&&h()),t.preventDefault())}}).on("input.mask paste.mask",function(){w.prop("readonly")||setTimeout(function(){var e=y(!0);w.caret(e),h()},0)}),r&&a&&w.off("input.mask").on("input.mask",function(){var e=w.val(),t=w.caret();if(f&&f.length&&f.length>e.length){for(y(!0);t.begin>0&&!c[t.begin-1];)t.begin--;if(0===t.begin)for(;t.begin<l&&!c[t.begin];)t.begin++;w.caret(t.begin,t.begin)}else{for(y(!0);t.begin<p&&!c[t.begin];)t.begin++;w.caret(t.begin,t.begin)}h()}),y()})}})}),$(document).ready(function(){$.mask.definitions.H="[0-2]",$.mask.definitions.h="[0-9]",$.mask.definitions.M="[0-5]",$.mask.definitions.m="[0-9]",$.mask.definitions.S="[0-5]",$.mask.definitions.s="[0-9]",$("#time").mask("Hh:Mm",{placeholder:" "}),$("input[name='hms']").mask("Hh:Mm:Ss",{placeholder:"0"})});
